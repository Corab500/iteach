<#include "/lib/layout.html">

<@layout_std pageId="home" modules = ["items", "schools", "students", "planning"] style=true breadcrumbs = {"page.index": ""}>
	<div class="container-fluid">
		<div id="home-row" class="row-fluid">
			<div class="span9">
				<!--Body content-->
				<@panel id="planning-panel" class="planning" title = loc("home.planning")>
					<div id="planning-calendar">
					</div>
				</@panel>
			</div>
			<div class="span3">
				<!-- Students -->
				<@panel class="data students" title = loc("home.students")>
					<table class="items students" width="100%">
						<tbody>
							<#list students.summaries as student>
								<@item color=student.school.color>
									<div class="student-name">${student.name?html}</div>
									<div class="student-description">${student.subject?html} @ ${student.school.name?html}</div>									
									<@item_actions>			
										<input id="student-name-${student.id}" type="hidden" value="${student.name?html}" />
										<input id="student-subject-${student.id}" type="hidden" value="${student.subject?html}" />
										<input id="student-school-${student.id}" type="hidden" value="${student.school.id?html}" />
										<img class="action action-delete" src="static/images/delete.png" title="${loc('student.delete',student.name)?html}" onclick="Students.deleteStudent(${student.id});" />
										<img class="action action-edit" src="static/images/edit.png" title="${loc('student.edit',student.name)?html}" onclick="Students.editStudent(${student.id});" />						
									</@item_actions>
								</@item>
							</#list>
						</tbody>
						<tfoot>
							<tr>
								<td>
                                       <button class="btn" onclick="Students.createStudent();">
                                           <img src="${base}/images/student_add.png" />
                                           <@lh key="student.new" />
                                       </button>
								</td>
							</tr>
						</tfoot>
					</table>
				</@panel>
				<!-- Schools -->
				<@panel class="data schools" title = loc("home.schools")>
					<table class="items schools" width="100%">
						<tbody>
							<#list schools.summaries as school>
								<@item color=school.color>
									${school.name?html}
									<@item_actions>
										<input id="school-name-${school.id}" type="hidden" value="${school.name?html}" />
										<input id="school-color-${school.id}" type="hidden" value="${school.color?html}" />
										<img class="action action-delete" src="static/images/delete.png" title="${loc('school.delete',school.name)?html}" onclick="Schools.deleteSchool(${school.id});" />
										<img class="action action-edit" src="static/images/edit.png" title="${loc('school.edit',school.name)?html}" onclick="Schools.editSchool(${school.id});" />
									</@item_actions>
								</@item>
							</#list>
						</tbody>
						<tfoot>
							<tr>
								<td>
                                    <button class="btn" onclick="Schools.createSchool();">
                                        <img src="${base}/images/school_add.png" />
                                        <@lh key="school.new" />
                                    </button>
								</td>
							</tr>
						</tfoot>
					</table>
				</@panel>
			</div>
		</div>
	</div>
	
	<#-- Dialogs -->
	
	<@student_dialog />
	
	<#-- School dialog -->
	
	<@dialog id="school-dialog">
		<form id="school-dialog-form" class="form-horizontal">
			<div class="control-group">
				<span class="help-block"><@lh key="school.new.tip" /></span>
			</div>
			<div class="control-group">
				<label class="control-label" for="schoolName"><@lh key="school.name" /></label>
				<div class="controls">
					<input id="schoolName" name="name" type="text" size="30" maxlength="80" required="required" />
				</div>
			</div>
			<div class="control-group">
				<label class="control-label" for="schoolColor"><@lh key="school.color" /></label>
				<div class="controls">
					<input id="schoolColor" name="color" type="color" size="6" maxlength="6" required="required" />
				</div>
			</div>
			<div class="control-group">
				<div class="controls">
					<button class="btn btn-primary" id="school-dialog-submit" type="submit"><@lh key="general.create" /></button>
					<a class="btn btn-link" href="javascript:$('#school-dialog').dialog('close')"><@lh key="general.cancel" /></a>
				</div>
			</div>
		</form>
	</@dialog>
	
</@layout_std>